<div class="table-wrap" id="materials-table-wrap" {% if is_oob %}hx-swap-oob="outerHTML"{% endif %}>
  <table class="table crm-table materials-table" id="materials-table">
    <thead>
      <tr>
        <th>ID</th>
        <th>–ù–∞–∑–≤–∞–Ω–∏–µ</th>
        <th>–ö–æ—Ä–æ—Ç–∫–æ–µ</th>
        <th>–¢–∏–ø</th>
        <th>–ï–¥.</th>
        <th>–ú–∞—Å—Ç–µ—Ä–∞</th>
        <th>–ê–∫—Ç–∏–≤–µ–Ω</th>
        <th>–û—Å—Ç–∞—Ç–æ–∫</th>
        <th class="actions-cell">–î–µ–π—Å—Ç–≤–∏—è</th>
      </tr>
    </thead>
    <tbody>
      {% for m in materials %}
      <tr>
        <td data-label="ID" class="crm-field"><span class="crm-value crm-nowrap">{{ m.id }}</span></td>
        <td data-label="–ù–∞–∑–≤–∞–Ω–∏–µ" class="crm-field"><span class="crm-value">{{ m.name }}</span></td>
        <td data-label="–ö–æ—Ä–æ—Ç–∫–æ–µ" class="crm-field"><span class="crm-value">{{ m.short_name or '' }}</span></td>
        <td data-label="–¢–∏–ø" class="crm-field"><span class="crm-value">{{ m.material_type.name if m.material_type else '' }}</span></td>
        <td data-label="–ï–¥." class="crm-field"><span class="crm-value crm-nowrap">{{ m.unit }}</span></td>
        <td data-label="–ú–∞—Å—Ç–µ—Ä–∞" class="masters-cell crm-field">
          {% set ms = m.allowed_masters if m.allowed_masters is defined else [] %}
          {% if not ms %}
            <span class="crm-value">–í—Å–µ</span>
          {% else %}
            <span class="crm-value">{% for u in ms %}{{ (u.first_name or '') ~ ' ' ~ (u.last_name or '') }}{% if not loop.last %}, {% endif %}{% endfor %}</span>
          {% endif %}
        </td>
        <td data-label="–ê–∫—Ç–∏–≤–µ–Ω" class="crm-field"><span class="crm-value crm-nowrap">{{ '–î–∞' if m.is_active else '–ù–µ—Ç' }}</span></td>
        <td data-label="–û—Å—Ç–∞—Ç–æ–∫" class="crm-field"><span class="crm-value crm-nowrap">{{ m.current_stock }} {{ m.unit }}</span></td>
        <td data-label="–î–µ–π—Å—Ç–≤–∏—è" class="actions-cell crm-actions">
          <button class="icon-btn has-tooltip" data-tooltip="–ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞ –æ—Å—Ç–∞—Ç–∫–∞"
                  hx-get="{{ url_for('materials_modal_set_remains', material_id=m.id) }}"
                  hx-target="#modal-body" hx-swap="innerHTML">üßÆ</button>
          <button class="icon-btn has-tooltip" data-tooltip="–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å"
                  hx-get="{{ url_for('materials_modal_edit', material_id=m.id) }}"
                  hx-target="#modal-body" hx-swap="innerHTML">‚úèÔ∏è</button>
          <button class="icon-btn warn has-tooltip" data-tooltip="–£–¥–∞–ª–∏—Ç—å"
                  hx-get="{{ url_for('materials_modal_delete', material_id=m.id) }}"
                  hx-target="#modal-body" hx-swap="innerHTML">üóë</button>
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>
