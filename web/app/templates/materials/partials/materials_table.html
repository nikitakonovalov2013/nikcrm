<div class="table-wrap" id="materials-table-wrap" {% if is_oob %}hx-swap-oob="outerHTML"{% endif %}>
  <table class="table materials-table" id="materials-table">
    <thead>
      <tr>
        <th>ID</th>
        <th>–ù–∞–∑–≤–∞–Ω–∏–µ</th>
        <th>–ö–æ—Ä–æ—Ç–∫–æ–µ</th>
        <th>–¢–∏–ø</th>
        <th>–ï–¥.</th>
        <th>–ú–∞—Å—Ç–µ—Ä–∞</th>
        <th>–ê–∫—Ç–∏–≤–µ–Ω</th>
        <th>–û—Å—Ç–∞—Ç–æ–∫</th>
        <th class="actions-cell">–î–µ–π—Å—Ç–≤–∏—è</th>
      </tr>
    </thead>
    <tbody>
      {% for m in materials %}
      <tr>
        <td>{{ m.id }}</td>
        <td>{{ m.name }}</td>
        <td>{{ m.short_name or '' }}</td>
        <td>{{ m.material_type.name if m.material_type else '' }}</td>
        <td>{{ m.unit }}</td>
        <td class="masters-cell">
          {% set ms = m.allowed_masters if m.allowed_masters is defined else [] %}
          {% if not ms %}
            –í—Å–µ
          {% else %}
            {% for u in ms %}{{ (u.first_name or '') ~ ' ' ~ (u.last_name or '') }}{% if not loop.last %}, {% endif %}{% endfor %}
          {% endif %}
        </td>
        <td>{{ '–î–∞' if m.is_active else '–ù–µ—Ç' }}</td>
        <td>{{ m.current_stock }} {{ m.unit }}</td>
        <td class="actions-cell">
          <button class="icon-btn has-tooltip" data-tooltip="–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å"
                  hx-get="{{ url_for('materials_modal_edit', material_id=m.id) }}"
                  hx-target="#modal-body" hx-swap="innerHTML">‚úèÔ∏è</button>
          <button class="icon-btn warn has-tooltip" data-tooltip="–£–¥–∞–ª–∏—Ç—å"
                  hx-get="{{ url_for('materials_modal_delete', material_id=m.id) }}"
                  hx-target="#modal-body" hx-swap="innerHTML">üóë</button>
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>
